import{d as V,r as S,F as H,t as _,v as E,x as i,J as oe,K as B,L as Y,M as K,N as ne,O as q,P as D,y as L,o as G,Q as se,z as U,A as fe,R as me,T as pe,S as he,U as ve,V as ye,W as ge,X as we,I as le,i as A,Y as ee,D as _e}from"./Df6XP6Dh.js";import{_ as re}from"./DlAUqK2U.js";const xe=V({__name:"FlyingPlane",props:{fromId:{},toId:{},isFlying:{type:Boolean}},emits:["finish"],setup(o,{emit:s}){const t=o,l=s,e=S({left:"0px",top:"0px",transform:"rotate(0deg)",opacity:0}),n=(c,r)=>{const u=document.querySelector(`[data-node-id="${c}"]`),a=document.querySelector(`[data-node-id="${r}"]`);if(!u||!a)return null;const f=u.getBoundingClientRect(),m=a.getBoundingClientRect(),p=f.top+f.height/2;return{start:{x:f.left+f.width/2,y:p},end:{x:m.left+m.width/2,y:p}}};return H(()=>t.isFlying,async c=>{if(!c)return;const r=n(t.fromId,t.toId);if(!r)return;const a=r.end.x>r.start.x?0:180;e.value={left:`${r.start.x}px`,top:`${r.start.y}px`,transform:`translate(-50%, -50%) rotate(${a}deg) scale(1)`,opacity:0},await new Promise(f=>requestAnimationFrame(f)),e.value={...e.value,opacity:1},await new Promise(f=>setTimeout(f,100)),e.value={left:`${r.end.x}px`,top:`${r.end.y}px`,transform:`translate(-50%, -50%) rotate(${a}deg) scale(1)`,opacity:1},setTimeout(()=>{e.value={...e.value,opacity:0,transform:`translate(-50%, -50%) rotate(${a}deg) scale(0.8)`},setTimeout(()=>l("finish"),300)},500)}),(c,r)=>(_(),E("div",{class:"fixed pointer-events-none z-50",style:oe({left:e.value.left,top:e.value.top,transform:e.value.transform,opacity:e.value.opacity,transition:"all 0.5s cubic-bezier(0.4, 0, 0.2, 1)"})},r[0]||(r[0]=[i("span",{class:"text-base"},"✈️",-1)]),4))}}),W=[{id:1,year:2024,season:"春"},{id:2,year:2024,season:"夏"},{id:3,year:2024,season:"秋"},{id:4,year:2024,season:"冬"}],be={class:"w-full relative"},Ee={class:"relative h-32 pt-4"},Se={class:"flex justify-between relative overflow-x-auto px-4 max-w-2xl mx-auto h-16"},$e=["data-node-id"],ke=["onClick"],Te=V({__name:"Timeline",props:{selectedEvent:{}},emits:["select"],setup(o,{emit:s}){const t=o,l=s,e=S({fromId:0,toId:0,isFlying:!1}),n=S(t.selectedEvent);H(()=>t.selectedEvent,u=>{n.value=u});const c=u=>{if(n.value&&n.value.id!==u.id){n.value=u,l("select",u);const a=document.querySelector(`[data-section-id="${u.id}"]`);if(!a)return;const f=a.getBoundingClientRect(),m=window.scrollY+f.top-100,p=()=>{const y=window.scrollY;Math.abs(y-m)<50&&(e.value={fromId:n.value.id,toId:u.id,isFlying:!0},window.removeEventListener("scroll",p))};window.addEventListener("scroll",p),setTimeout(()=>{window.removeEventListener("scroll",p)},5e3)}else n.value=u,l("select",u)},r=()=>{e.value.isFlying=!1};return(u,a)=>{const f=xe;return _(),E("div",be,[i("div",Ee,[i("div",Se,[a[0]||(a[0]=i("div",{class:"absolute left-4 right-4 top-1/2 h-0 border-t-2 border-dashed border-warm-gray-300/50"},null,-1)),(_(!0),E(B,null,Y(K(W),m=>{var p,y;return _(),E("div",{key:m.id,class:"relative flex flex-col items-center flex-shrink-0 group mx-6"},[i("div",{class:"absolute top-1/2 -translate-y-1/2 z-10 bg-warm-gray-100/75 rounded-full p-0.5","data-node-id":m.id},[i("button",{class:D(["transition-allease-in-out focus:outline-none rounded-full",[((p=n.value)==null?void 0:p.id)===m.id?"w-5 h-5 bg-warm-gray-600 ring-1 ring-warm-gray-400 ring-offset-1 ring-offset-warm-gray-100 scale-110":"w-5 h-5 bg-white border border-warm-gray-400 hover:border-warm-gray-600 hover:scale-105"]]),onClick:$=>c(m)},null,10,ke)],8,$e),i("h3",{class:D(["text-sm font-medium transition-colors duration-300 whitespace-nowrap absolute top-12 left-1/2 -translate-x-1/2",[((y=n.value)==null?void 0:y.id)===m.id?"text-warm-gray-800 font-bold":"text-warm-gray-600"]])},L(m.year)+"年"+L(m.season),3)])}),128))])]),e.value.isFlying?(_(),ne(f,{key:0,"from-id":e.value.fromId,"to-id":e.value.toId,"is-flying":e.value.isFlying,onFinish:r},null,8,["from-id","to-id","is-flying"])):q("",!0)])}}}),Ce=re(Te,[["__scopeId","data-v-3bff1157"]]),Pe={class:"flex min-h-screen items-center justify-center p-4"},Le={class:"flex flex-col md:flex-row"},Me={class:"relative aspect-w-4 aspect-h-3"},Ie=["src","alt"],Fe={key:0,class:"md:w-1/3 p-6"},Re={class:"mb-4"},De={class:"flex items-center gap-2 mb-3"},Oe={class:"text-xl font-medium text-warm-gray-800"},je={class:"text-warm-gray-600"},Be={class:"mt-2 text-warm-gray-600 leading-relaxed"},We=V({__name:"PhotoModal",props:{photo:{},isOpen:{type:Boolean}},emits:["close"],setup(o,{emit:s}){const t=s,l=e=>{e.key==="Escape"&&t("close")};return G(()=>{document.addEventListener("keydown",l)}),se(()=>{document.removeEventListener("keydown",l)}),(e,n)=>(_(),ne(he,{to:"body"},[U(pe,{"enter-active-class":"transition duration-300 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-200 ease-in","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-95 opacity-0"},{default:fe(()=>[e.isOpen&&e.photo?(_(),E("div",{key:0,class:"fixed inset-0 z-[100] overflow-y-auto",onClick:n[1]||(n[1]=me(c=>t("close"),["self"]))},[n[4]||(n[4]=i("div",{class:"fixed inset-0 bg-black bg-opacity-75 backdrop-blur-sm"},null,-1)),i("div",Pe,[i("div",{class:D(["relative w-full rounded-lg overflow-hidden",[e.photo.story?"max-w-6xl bg-warm-gray-100":"max-w-4xl"]])},[i("div",Le,[i("div",{class:D([e.photo.story?"md:w-2/3":"w-full"])},[i("div",Me,[i("img",{src:e.photo.src,alt:e.photo.alt,class:D(["w-full h-full object-cover",[e.photo.story?"md:rounded-l-lg":"rounded-lg"]])},null,10,Ie)])],2),e.photo.story?(_(),E("div",Fe,[i("div",Re,[i("div",De,[i("h3",Oe,L(e.photo.year)+"年"+L(e.photo.season),1),n[2]||(n[2]=i("span",{class:"text-warm-gray-500"},"·",-1)),i("span",je,L(e.photo.location),1)]),i("p",Be,L(e.photo.story),1)])])):q("",!0)]),i("button",{class:D(["absolute top-4 right-4 transition-colors duration-200 rounded-full p-1.5",[e.photo.story?"text-warm-gray-400 hover:text-warm-gray-600 bg-transparent":"text-white hover:text-white/80 mix-blend-difference bg-white/10 backdrop-blur-sm"]]),onClick:n[0]||(n[0]=c=>t("close"))},n[3]||(n[3]=[i("span",{class:"sr-only"},"关闭",-1),i("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),2)],2)])])):q("",!0)]),_:1})]))}});function ae(o){return ge()?(we(o),!0):!1}function k(o){return typeof o=="function"?o():K(o)}const Ae=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ze=Object.prototype.toString,Ne=o=>ze.call(o)==="[object Object]",O=()=>{};function ie(o,s){function t(...l){return new Promise((e,n)=>{Promise.resolve(o(()=>s.apply(this,l),{fn:s,thisArg:this,args:l})).then(e).catch(n)})}return t}function Ve(o,s={}){let t,l,e=O;const n=r=>{clearTimeout(r),e(),e=O};return r=>{const u=k(o),a=k(s.maxWait);return t&&n(t),u<=0||a!==void 0&&a<=0?(l&&(n(l),l=null),Promise.resolve(r())):new Promise((f,m)=>{e=s.rejectOnCancel?m:f,a&&!l&&(l=setTimeout(()=>{t&&n(t),l=null,f(r())},a)),t=setTimeout(()=>{l&&n(l),l=null,f(r())},u)})}}function He(...o){let s=0,t,l=!0,e=O,n,c,r,u,a;!ve(o[0])&&typeof o[0]=="object"?{delay:c,trailing:r=!0,leading:u=!0,rejectOnCancel:a=!1}=o[0]:[c,r=!0,u=!0,a=!1]=o;const f=()=>{t&&(clearTimeout(t),t=void 0,e(),e=O)};return p=>{const y=k(c),$=Date.now()-s,M=()=>n=p();return f(),y<=0?(s=Date.now(),M()):($>y&&(u||!l)?(s=Date.now(),M()):r&&(n=new Promise((I,b)=>{e=a?b:I,t=setTimeout(()=>{s=Date.now(),l=!0,I(M()),f()},Math.max(0,y-$))})),!u&&!t&&(t=setTimeout(()=>l=!0,y)),l=!1,n)}}function Ye(o){return le()}function qe(o,s=200,t={}){return ie(Ve(s,t),o)}function ce(o,s=200,t=!1,l=!0,e=!1){return ie(He(s,t,l,e),o)}function ue(o,s=!0,t){Ye()?G(o,t):s?o():ye(o)}function de(o){var s;const t=k(o);return(s=t==null?void 0:t.$el)!=null?s:t}const Q=Ae?window:void 0;function X(...o){let s,t,l,e;if(typeof o[0]=="string"||Array.isArray(o[0])?([t,l,e]=o,s=Q):[s,t,l,e]=o,!s)return O;Array.isArray(t)||(t=[t]),Array.isArray(l)||(l=[l]);const n=[],c=()=>{n.forEach(f=>f()),n.length=0},r=(f,m,p,y)=>(f.addEventListener(m,p,y),()=>f.removeEventListener(m,p,y)),u=H(()=>[de(s),k(e)],([f,m])=>{if(c(),!f)return;const p=Ne(m)?{...m}:m;n.push(...t.flatMap(y=>l.map($=>r(f,y,$,p))))},{immediate:!0,flush:"post"}),a=()=>{u(),c()};return ae(a),a}function Ue(){const o=S(!1),s=le();return s&&G(()=>{o.value=!0},s),o}function Ge(o){const s=Ue();return A(()=>(s.value,!!o()))}function Qe(o,s={}){const{window:t=Q}=s,l=Ge(()=>t&&"matchMedia"in t&&typeof t.matchMedia=="function");let e;const n=S(!1),c=a=>{n.value=a.matches},r=()=>{e&&("removeEventListener"in e?e.removeEventListener("change",c):e.removeListener(c))},u=_e(()=>{l.value&&(r(),e=t.matchMedia(k(o)),"addEventListener"in e?e.addEventListener("change",c):e.addListener(c),n.value=e.matches)});return ae(()=>{u(),r(),e=void 0}),n}const te=1;function Xe(o,s={}){const{throttle:t=0,idle:l=200,onStop:e=O,onScroll:n=O,offset:c={left:0,right:0,top:0,bottom:0},eventListenerOptions:r={capture:!1,passive:!0},behavior:u="auto",window:a=Q,onError:f=d=>{console.error(d)}}=s,m=S(0),p=S(0),y=A({get(){return m.value},set(d){M(d,void 0)}}),$=A({get(){return p.value},set(d){M(void 0,d)}});function M(d,P){var w,j,z,F;if(!a)return;const T=k(o);if(!T)return;(z=T instanceof Document?a.document.body:T)==null||z.scrollTo({top:(w=k(P))!=null?w:$.value,left:(j=k(d))!=null?j:y.value,behavior:k(u)});const N=((F=T==null?void 0:T.document)==null?void 0:F.documentElement)||(T==null?void 0:T.documentElement)||T;y!=null&&(m.value=N.scrollLeft),$!=null&&(p.value=N.scrollTop)}const I=S(!1),b=ee({left:!0,right:!1,top:!0,bottom:!1}),h=ee({left:!1,right:!1,top:!1,bottom:!1}),g=d=>{I.value&&(I.value=!1,h.left=!1,h.right=!1,h.top=!1,h.bottom=!1,e(d))},x=qe(g,t+l),v=d=>{var P;if(!a)return;const w=((P=d==null?void 0:d.document)==null?void 0:P.documentElement)||(d==null?void 0:d.documentElement)||de(d),{display:j,flexDirection:z}=getComputedStyle(w),F=w.scrollLeft;h.left=F<m.value,h.right=F>m.value;const T=Math.abs(F)<=(c.left||0),N=Math.abs(F)+w.clientWidth>=w.scrollWidth-(c.right||0)-te;j==="flex"&&z==="row-reverse"?(b.left=N,b.right=T):(b.left=T,b.right=N),m.value=F;let R=w.scrollTop;d===a.document&&!R&&(R=a.document.body.scrollTop),h.top=R<p.value,h.bottom=R>p.value;const J=Math.abs(R)<=(c.top||0),Z=Math.abs(R)+w.clientHeight>=w.scrollHeight-(c.bottom||0)-te;j==="flex"&&z==="column-reverse"?(b.top=Z,b.bottom=J):(b.top=J,b.bottom=Z),p.value=R},C=d=>{var P;if(!a)return;const w=(P=d.target.documentElement)!=null?P:d.target;v(w),I.value=!0,x(d),n(d)};return X(o,"scroll",t?ce(C,t,!0,!1):C,r),ue(()=>{try{const d=k(o);if(!d)return;v(d)}catch(d){f(d)}}),X(o,"scrollend",g,r),{x:y,y:$,isScrolling:I,arrivedState:b,directions:h,measure(){const d=k(o);a&&d&&v(d)}}}function Ke(o={}){const{window:s=Q,initialWidth:t=Number.POSITIVE_INFINITY,initialHeight:l=Number.POSITIVE_INFINITY,listenOrientation:e=!0,includeScrollbar:n=!0}=o,c=S(t),r=S(l),u=()=>{s&&(n?(c.value=s.innerWidth,r.value=s.innerHeight):(c.value=s.document.documentElement.clientWidth,r.value=s.document.documentElement.clientHeight))};if(u(),ue(u),X("resize",u,{passive:!0}),e){const a=Qe("(orientation: portrait)");H(a,()=>u())}return{width:c,height:r}}const Je=[{id:1,src:"https://picsum.photos/seed/spring2024/800/600",year:2024,season:"春",alt:"2024年春季风景 - 春暖花开",story:"那天阳光正好，樱花盛开。漫步在林间小道，一切都充满了生机。",location:"公园"},{id:2,src:"https://picsum.photos/seed/spring2024-2/800/600",year:2024,season:"春",alt:"2024年春季风景 - 春日庭院",story:"在家里的小院子里种下了一些花草。",location:"家"},{id:3,src:"https://picsum.photos/seed/summer2024/800/600",year:2024,season:"夏",alt:"2024年夏季风景 - 夏日海滩",location:"家"},{id:4,src:"https://picsum.photos/seed/autumn2024/800/600",year:2024,season:"秋",alt:"2024年秋季风景 - 秋色宜人",location:"家"},{id:5,src:"https://picsum.photos/seed/winter2024/800/600",year:2024,season:"冬",alt:"2024年冬季风景 - 冬雪纷飞",location:"家"}],Ze={photos:Je},et=["data-section-id"],tt={class:"mb-6"},ot={class:"text-xl font-medium text-warm-gray-800"},nt={class:"space-y-8"},st={class:"flex items-center gap-2 mb-4"},lt={class:"text-lg font-medium text-warm-gray-700"},rt=["onClick"],at={class:"aspect-w-4 aspect-h-3 relative"},it=["src","alt"],ct=V({__name:"PhotoGallery",props:{selectedEvent:{}},emits:["updateSelectedEvent"],setup(o,{emit:s}){const{width:t}=Ke(),{y:l}=Xe(window),e=S(null),n=S(new Map),c=S(null),r=S(!1),u=Ze.photos,a=o,f=s,m=A(()=>t.value>1100?"33%":t.value>700?"50%":"100%");A(()=>a.selectedEvent?u.filter(h=>{var g,x;return h.year===((g=a.selectedEvent)==null?void 0:g.year)&&h.season===((x=a.selectedEvent)==null?void 0:x.season)}):u);const p=h=>{c.value=h,r.value=!0},y=()=>{c.value=null,r.value=!1},$=A(()=>{const h=new Map;return W.forEach(g=>{const x=`${g.year}-${g.season}`;h.set(x,u.filter(v=>v.year===g.year&&v.season===g.season))}),h}),M=h=>{const g=new Map;return h.forEach(x=>{g.has(x.location)||g.set(x.location,[]),g.get(x.location).push(x)}),g},b=ce(()=>{if(!e.value)return;const h=Array.from(n.value.entries());if(h.length===0)return;const g=window.innerHeight/3;let x=h[0];for(const C of h)if(C[1].getBoundingClientRect().top<=g)x=C;else break;const v=W.find(C=>C.id===x[0]);v&&(!a.selectedEvent||a.selectedEvent.id!==v.id)&&f("updateSelectedEvent",v)},100);return H(l,()=>{b()}),G(()=>{W.length>0&&!a.selectedEvent&&f("updateSelectedEvent",W[0]),b()}),se(()=>{b.stop()}),(h,g)=>{const x=We;return _(),E("div",{ref_key:"galleryRef",ref:e,class:"space-y-12"},[(_(!0),E(B,null,Y(K(W),v=>{var C;return _(),E(B,{key:`section-${v.id}`},[(C=$.value.get(`${v.year}-${v.season}`))!=null&&C.length?(_(),E("section",{key:0,ref_for:!0,ref:d=>n.value.set(v.id,d),"data-section-id":v.id,class:D(v.id===1?"relative pt-20":"relative")},[i("div",tt,[i("h2",ot,L(v.year)+"年"+L(v.season),1)]),i("div",nt,[(_(!0),E(B,null,Y(M($.value.get(`${v.year}-${v.season}`)||[]),([d,P])=>(_(),E(B,{key:d},[i("div",st,[g[0]||(g[0]=i("svg",{class:"w-5 h-5 text-warm-gray-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})],-1)),i("h3",lt,L(d),1)]),i("div",{class:"grid gap-4",style:oe({gridTemplateColumns:`repeat(auto-fill, minmax(${m.value}, 1fr))`})},[(_(!0),E(B,null,Y(P,w=>(_(),E("div",{key:w.id,class:"bg-white rounded-lg shadow-md overflow-hidden mb-4 transition-all duration-300 hover:shadow-xl cursor-pointer",onClick:j=>p(w)},[i("div",at,[i("img",{src:w.src,alt:w.alt,class:"w-full h-full object-cover hover:scale-105 transition-transform duration-300",loading:"lazy"},null,8,it)])],8,rt))),128))],4)],64))),128))])],10,et)):q("",!0)],64)}),128)),U(x,{photo:c.value,"is-open":r.value,onClose:y},null,8,["photo","is-open"])],512)}}}),ut=re(ct,[["__scopeId","data-v-c634f6ca"]]),dt={class:"min-h-screen bg-warm-gray-100"},ft={class:"fixed top-0 left-0 right-0 z-10 backdrop-blur-md bg-warm-gray-100/75 shadow-sm"},mt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},pt={class:"flex items-center h-20"},ht={class:"grow pt-6 pb-3"},vt={class:"pt-24 p-4 sm:p-6"},yt={class:"max-w-7xl mx-auto"},_t=V({__name:"index",setup(o){const s=S(null),t=e=>{s.value=e;const n=document.querySelector(`[data-section-id="${e.id}"]`);if(n){const r=n.getBoundingClientRect().top+window.scrollY-100;window.scrollTo({top:r,behavior:"smooth"})}},l=e=>{s.value=e};return(e,n)=>{const c=Ce,r=ut;return _(),E("div",dt,[i("nav",ft,[i("div",mt,[i("div",pt,[n[0]||(n[0]=i("h1",{class:"text-2xl font-serif text-warm-gray-800 whitespace-nowrap transition-colors duration-300 hover:text-warm-gray-600 mr-8"}," 小猫咪の树洞 ",-1)),i("div",ht,[U(c,{"selected-event":s.value,onSelect:t},null,8,["selected-event"])])])])]),i("main",vt,[i("div",yt,[U(r,{"selected-event":s.value,onUpdateSelectedEvent:l},null,8,["selected-event"])])])])}}});export{_t as default};
